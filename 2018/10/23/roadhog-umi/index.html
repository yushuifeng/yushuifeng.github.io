
<!DOCTYPE html>
<html lang="" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SF.Y</title>

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="Fechin,"> 
    <meta name="description" content="记脚手架升级现有脚手架使用半年有余了，各依赖一直没有升级。前几天开发过程中出现了开发环境使用了最新版 API 而测试环境上不支持而引发报错的问题。
对依赖进行升级的过程中关注到了基础脚手架的版本,"> 
    <meta name="author" content="SF.Y"> 
    <link rel="alternative" href="atom.xml" title="SF.Y" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.ico"> 
    <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <link rel="stylesheet" href="/css/diaspora.css">
</head>

<body class="loading">
    <div id="loader"></div>
    <div id="single">
    <div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <a class="icon-home image-icon" href="javascript:;"></a>
    <div title="播放/暂停" class="icon-play"></div>
    <h3 class="subtitle">roadhog -> umi</h3>
    <div class="social">
        <!--<div class="like-icon">-->
            <!--<a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
        <!--</div>-->
        <div>
            <div class="share">
                <a title="获取二维码" class="icon-scan" href="javascript:;"></a>
            </div>
            <div id="qr"></div>
        </div>
    </div>
    <div class="scrollbar"></div>
</div>
    <div class="section">
        <div class="article">
    <div class='main'>
        <h1 class="title">roadhog -> umi</h1>
        <div class="stuff">
            <span>十月 23, 2018</span>
            

        </div>
        <div class="content markdown">
            <h1 id="记脚手架升级"><a href="#记脚手架升级" class="headerlink" title="记脚手架升级"></a>记脚手架升级</h1><p>现有脚手架使用半年有余了，各依赖一直没有升级。前几天开发过程中出现了开发环境使用了最新版 API 而测试环境上不支持而引发报错的问题。</p>
<p>对依赖进行升级的过程中关注到了基础脚手架的版本，对其了解后进而进行了整体的升级：从 ant-design-pro v1.0 -&gt; v2.1</p>
<p>借鉴上次的经验，直接去 <img src="https://gw.alipayobjects.com/zos/rmsportal/KDpgvguMpGfqaHPjicRK.svg" width="10"> <a href="https://pro.ant.design/docs/upgrade-v2-cn" target="_blank" rel="noopener">ant-design-pro</a> 官网，文档中有升级到2.0版本的详细步骤。本质上要的就是脚手架的变化，roadhog -&gt; umi！</p>
<p>没有什么特殊的问题，按照步骤操作就可以。<br>摘抄一下官网的条目：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- 把 package.json roadhog 的依赖修改为 umi。</span><br><span class="line">- 拷贝 .webpackrc.js 中的配置到 config/config.js 中。</span><br><span class="line">- 修改 src/routes 目录名称为 pages，pages 是 umi 约定的目录。</span><br><span class="line">- 删除 src/models/index.js，在 umi 中 models 文件夹中的 dva model 会被自动挂载。</span><br><span class="line">- 重命名 index.ejs 为 pages/document.ejs，它是 umi 约定的文件。</span><br><span class="line">- 修改 index.less 为 global.less 和修改 index.js 为 global.js，他们也是 umi 约定的文件。</span><br><span class="line">- 在 config/config.js 中添加路由配置 routes。</span><br><span class="line">- 修改 src/layouts/BasicLayout.js 中的组件嵌套语法。</span><br><span class="line">- 修改 404 页面。</span><br><span class="line">- 修改权限路由 AuthorizedRoute 的逻辑。</span><br><span class="line">- 修改 mock。</span><br><span class="line">- 在 .gitignore 中添加 umi 相关文件。</span><br><span class="line">- 通过执行 tnpm start 和 tnpm run lint 修改可能出现的问题。</span><br></pre></td></tr></table></figure></p>
<p>注意一定要先了解一下 <a href="https://umijs.org/zh/" target="_blank" rel="noopener">UmiJS</a> ！</p>
<h1 id="【附：迁移步骤细节】"><a href="#【附：迁移步骤细节】" class="headerlink" title="【附：迁移步骤细节】"></a>【附：迁移步骤细节】</h1><h3 id="修改-roadhog-依赖为-umi"><a href="#修改-roadhog-依赖为-umi" class="headerlink" title="修改 roadhog 依赖为 umi"></a>修改 roadhog 依赖为 umi</h3><p>打开项目根目录下的 <figure class="highlight plain"><figcaption><span>umi：</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">&quot;dependencies&quot;: &#123;</span><br><span class="line">- &quot;dva&quot;: &quot;^2.2.3&quot;,</span><br><span class="line">- &quot;dva-loading&quot;: &quot;^2.0.3&quot;,</span><br><span class="line">- &quot;react-dom&quot;: &quot;^16.4.1&quot;,</span><br><span class="line">- &quot;react-loadable&quot;: &quot;^5.5.0&quot;,</span><br><span class="line">  ...</span><br><span class="line">&#125;,</span><br><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">+ &quot;umi&quot;: &quot;^2.0.0&quot;,</span><br><span class="line">+ &quot;umi-plugin-react&quot;: &quot;^1.0.0&quot;,</span><br><span class="line">- &quot;roadhog&quot;: &quot;^2.4.2&quot;,</span><br><span class="line">- &quot;roadhog-api-doc&quot;: &quot;^1.1.2&quot;,</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在 umi 中内置了 React，通过 umi-plugin-react 插件集内置了 antd 和 dva 等 React 技术栈常用的库。可以参考 <a href="https://umijs.org/plugin/umi-plugin-react.html" target="_blank" rel="noopener">umi-plugin-react</a> 的文档。</p>
<p>另外 <figure class="highlight plain"><figcaption><span>中的 scripts 也要做对应的修改：</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">- &quot;start&quot;: &quot;cross-env ESLINT=none roadhog dev&quot;,</span><br><span class="line">- &quot;start:no-proxy&quot;: &quot;cross-env NO_PROXY=true ESLINT=none roadhog dev&quot;,	    </span><br><span class="line">- &quot;build&quot;: &quot;cross-env ESLINT=none roadhog build&quot;,</span><br><span class="line">+ &quot;start&quot;: &quot;umi dev&quot;,</span><br><span class="line">+ &quot;start:no-mock&quot;: &quot;cross-env MOCK=none umi dev&quot;,</span><br><span class="line">+ &quot;build&quot;: &quot;umi build&quot;,</span><br></pre></td></tr></table></figure></p>
<p>修改完成之后记得不要忘记使用 <figure class="highlight plain"><figcaption><span>update``` 将依赖更新到最新。</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 添加配置文件 config/config.js#</span><br><span class="line">umi 约定了 ```.umirc.js``` 和 ```config/config.js``` 为 umi 的配置文件（二选一），在 Ant Design Pro 中因为配置比较多，我们选择使用 config/config.js。</span><br><span class="line"></span><br><span class="line">你需要在项目中创建 ```config/config.js```，该配置文件需要默认导出一个对象，里面包含了 umi 的全部配置。你可以先初始化为如下内容：</span><br></pre></td></tr></table></figure></p>
<p>export default {<br>  plugins: [[<br>    ‘umi-plugin-react’,<br>    {<br>      antd: true,<br>      dva: {<br>        hmr: true,<br>      },<br>    }<br>  ]]<br>};<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">该配置会挂载 umi-plugin-react 插件集并打开 antd 和 dva 插件，使得你在项目中可以直接使用 antd 和 dva。</span><br><span class="line"></span><br><span class="line">添加 ```config/config.js``` 之后你可以将你项目下的 ```.webpackrc.js``` 中的配置也迁移到 ```config/config.js``` 中。 ```.webpackrc.js``` 是 ```af-webpack``` 的配置文件，umi 和 roadhog 都是依赖于它，所以你可以直接迁移过来。迁移过来之后就可以删除原有的 .webpackrc.js 和 .babelrc.js 文件了。</span><br><span class="line"></span><br><span class="line">不过需要注意的是 .webpackrc.js 中的如下配置是没有必要复制到 config/config.js 中的：</span><br><span class="line"></span><br><span class="line">+ entry: umi 会有默认的路由机制，需要删除该配置。</span><br><span class="line"></span><br><span class="line">+ extraBabelPlugins: umi-plugin-react 中会内置对 antd 的按需编译的支持，不再需要手动配置。</span><br><span class="line"></span><br><span class="line">+ env: env 下的 dva-hmr 插件不再需要，可以直接在 umi-plugin-react 配置中开启。</span><br><span class="line"></span><br><span class="line">+ alias: umi 中默认会添加 @/ 的别名到 src 目录。</span><br><span class="line"></span><br><span class="line">+ html: umi 默认使用 src/pages/document.ejs 作为 html 模板。</span><br><span class="line"></span><br><span class="line">另外我们推荐将 theme 配置直接写到 ```config/config.js``` 中，然后就可以删除掉 ```src/theme.js``` 了。</span><br><span class="line"></span><br><span class="line">### 修改 routes 为 pages</span><br><span class="line">在 umi 中大量使用了约定和配置来高效的实现一些功能，其中 umi 就约定了 ```src/pages``` 目录为页面组件的存放目录。在 Ant Design Pro 1.0 中，我们的页面都存放在 ```src/routes``` 下面，所以我们只需要将 routes 重命名为 pages 即可。</span><br><span class="line"></span><br><span class="line">### 删除 models/index.js</span><br><span class="line">在 umi 中，挂载了 dva 的插件之后 models 下的文件会被默认当做 dva model 引入，所以不再需要在 ```models/index.js``` 中来手动挂载 model，可以直接删除该文件。</span><br><span class="line"></span><br><span class="line">### 修改 index.ejs</span><br><span class="line">移动 ```index.ejs``` 到 ```pages/document.ejs```，它是 umi 约定的文件。参考 [umi HTML 模板文档](https://umijs.org/guide/html-template.html)。</span><br><span class="line"></span><br><span class="line">### 修改 index.js 和 index.less</span><br><span class="line">重命名 ```index.js``` 为 ```global.js```，重命名 ```index.less``` 为 ```global.less```，他们会被 umi 自动挂载。可以参考 umi 的目录约定。另外因为 dva 插件会自动挂载 model 并默认添加 dva-loading 插件，所以 index.js 中的 dva 相关的内容可以被移除了。只需要保留类似下面这些初始化逻辑：</span><br></pre></td></tr></table></figure></p>
<p>import ‘./polyfill’;<br>import ‘moment/locale/zh-cn’;<br>import ‘./rollbar’;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">另外 ```global.less``` 中的 ```:global``` 标志也可以移除了，因为 ```global.less``` 中的样式默认就是全局的，这里要注意的是除了它其它都会默认使用 cssModule。</span><br><span class="line"></span><br><span class="line">### 添加路由配置</span><br><span class="line">这一步是最重要的，umi 内置了路由的实现，提供了约定式和配置式两种路由方式。在 Ant Design Pro 中我们使用配置式路由的方式。你需要在 ```config/config.js``` 中添加配置项 routes，在这里我们基于 ```/dashboard``` 页面提供了一个样例，你需要按照你的项目具体做下迁移。我们推荐添加一个 ```config/router.config.js``` 的文件然后在 ```config/config.js``` 中引入它：</span><br></pre></td></tr></table></figure></p>
<p>// config/router.config.js<br>module.exports = [<br>  {<br>    path: ‘/‘,<br>    component: ‘../layouts/BasicLayout’,<br>    routes: [<br>      // dashboard<br>      { path: ‘/‘, redirect: ‘/dashboard/analysis’ },<br>      {<br>        path: ‘/dashboard’,<br>        name: ‘dashboard’,<br>        icon: ‘dashboard’,<br>        routes: [<br>          { path: ‘/dashboard/analysis’, name: ‘analysis’, component: ‘./Dashboard/Analysis’ },<br>          { path: ‘/dashboard/monitor’, name: ‘monitor’, component: ‘./Dashboard/Monitor’ },<br>          { path: ‘/dashboard/workplace’, name: ‘workplace’, component: ‘./Dashboard/Workplace’ },<br>        ],<br>      },<br>    ],<br>  },<br>];<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">其中 component 是一个字符串，是相对于 ```src/pages``` 的路径，更多的路由配置你可以参考 v2 版本的路由配置，和 umi 的文档。另外原有的 1.0 版本的路由代码 ```src/common/router.js``` 和 ```src/router.js``` 也可以删除了。</span><br><span class="line"></span><br><span class="line">### 修改布局组件</span><br><span class="line">因为不在使用 react-router@4 的组件式路由，所以你需要修改你的布局组件。把其中的 ```&lt;Switch/&gt;``` 组件部分修改为 ```&#123;this.props.children&#125;```。</span><br><span class="line"></span><br><span class="line">### 修改 404 页面</span><br><span class="line">在 umi 中默认使用 ```src/pages/404.js``` 作为 404 页面，你需要将原来的 ```src/routes/Exception/404.js``` 迁移过去。</span><br><span class="line"></span><br><span class="line">### 修改权限路由</span><br><span class="line">在 2.0 中，你可以直接使用 umi 提供的权限路由的方案。当然你也可以保留 1.0 中的方案继续使用。由于不是必要的，在本文中就不做具体说明了。</span><br><span class="line"></span><br><span class="line">### 修改 mock 数据</span><br><span class="line">在 umi 中，默认会将 ```mock/*.js``` 的文件作为 mock 文件。所以可以将 mock 数据的 URL 信息迁移到 mock 文件中后删除 ```.roadhogrc.mock.js``` 文件，但是要注意的是直接写在 ```.roadhogrc.mock.js``` 中的 mock 数据需要迁移出来，比如可以新建 ```mock/common.js``` 来迁移这部分数据。</span><br><span class="line"></span><br><span class="line">更多说明可以参考 umi 的文档[Mock 数据](https://umijs.org/guide/mock-data.html)。</span><br><span class="line"></span><br><span class="line">### 修改 .gitignore</span><br><span class="line">使用 umi 后你需要将 umi 在开发和构建中的临时文件添加到 .gitignore 里面。</span><br></pre></td></tr></table></figure></p>
<p>.umi<br>.umi-production<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">### 修改代码别名等细节</span><br><span class="line">以上的操作完成之后你就可以运行 ```npm start``` 启动你的项目了，你会看到报错，但是不要慌，按照报错信息一步一步修改即可。你可能需要修改的内容有：</span><br><span class="line"></span><br><span class="line">- 修改别名 ```components/``` 为 ```@/components```。当然你也可以直接在 ```config/config.js``` 保留原有的别名。</span><br><span class="line"></span><br><span class="line">- 修改 ```src/utils/request.js``` 中和 dva 相关的部分。可以直接使用 ```umi/router``` 来做跳转。</span><br><span class="line"></span><br><span class="line">- ```src/utils/request.js``` 的 ```/exception/400``` 可以改为 ```/400```。</span><br><span class="line"></span><br><span class="line">- 去掉 ```BasicLayout``` 中的 ```const baseRedirect = this.getBaseRedirect();``` 相关逻辑，跳转的逻辑可以通过 umi 的 routes 配置实现。</span><br><span class="line"></span><br><span class="line">- 修改 ```BasicLayout``` 中的 ```getPageTitle``` 和 ```getBreadcrumbNameMap``` 的相关逻辑，参考下面的代码实现。完整代码参考 v1 升级 [commit](https://github.com/ant-design/ant-design-pro/commit/dc2118db78f9b2b7072051fea558e8d1386ce34c)。</span><br><span class="line"></span><br><span class="line">注：```memoizeOne``` 是 ```memoize-one npm``` 包提供的方法，你需要先 install memoize-one。```deepEqual``` 是 ```lodash.isequal``` 包提供的，也需要安装相关依赖。</span><br></pre></td></tr></table></figure></p>
<p>/**</p>
<ul>
<li>获取面包屑映射</li>
<li>@param {Object} menuData 菜单配置<br>*/<br>const getBreadcrumbNameMap = memoizeOne(meun =&gt; {<br>const routerMap = {};<br>const mergeMeunAndRouter = meunData =&gt; {<br> meunData.forEach(meunItem =&gt; {<br>   if (meunItem.children) {<pre><code>mergeMeunAndRouter(meunItem.children);
</code></pre>   }<br>   // Reduce memory usage<br>   routerMap[meunItem.path] = meunItem;<br> });<br>};<br>mergeMeunAndRouter(meun);<br>return routerMap;<br>}, deepEqual);<br><code>`</code><br>除了项目能够正常启动，你还应该再运行下 tnpm run lint 来解决下部分在迁移过程中产生的比较低级的问题。你可能需要处理的问题和方案如下：</li>
</ul>
<ul>
<li><p><code>no-unused-vars</code> 错误，检查下没有问题就可以删除它了。</p>
</li>
<li><p><code>react/destructuring-assignment</code> 错误，你可能需要修改类似 <code>this.props.children</code> 为 <code>const { children } = this.props</code> 之类的错误。</p>
</li>
</ul>
<p>另外我们推荐你迁移到 2.0 推荐的 lint 规则，让你的代码更优雅。</p>
<h2 id="使用-2-0-中的新功能"><a href="#使用-2-0-中的新功能" class="headerlink" title="使用 2.0 中的新功能"></a>使用 2.0 中的新功能</h2><p>完成 roadhog 到 umi 的迁移后要使用 2.0 的新功能就会变得简单。2.0 中我们主要有如下的新特性添加：</p>
<ul>
<li>新增用户信息页面。</li>
<li>支持国际化。</li>
<li>支持风格切换。</li>
</ul>
<h3 id="新增用户信息页面"><a href="#新增用户信息页面" class="headerlink" title="新增用户信息页面"></a>新增用户信息页面</h3><p>你只需要将 v2 pages 目录下对应的代码 copy 到你的项目中并在 <code>config/config.js</code> 中修改 routes 配置即可。这部分相对来说比较简单，这里不做过多说明。另外除了新增的用户信息页面外，你也可以参考其他页面的更新去跳转你自己项目中的代码。</p>
<h3 id="支持国际化"><a href="#支持国际化" class="headerlink" title="支持国际化"></a>支持国际化</h3><p>在 Ant Design Pro 2.0 中我们使用了 umi 的插件 <code>umi-plugin-locale</code> 来实现国际化。该插件也已经内置到了 <code>umi-plugin-react</code> 插件集中。你可以在该插件集的配置中添加 locale 配置来开启国际化。</p>
<p>开启国际化插件之后你就可以在项目目录下添加 <code>locales</code> 文件夹，按照约定添加国际化资源文件后就可以通过在项目中使用 <code>umi/locale</code> 暴露的 API 来实现国际化了。</p>
<p>更多关于 <code>umi-plugin-locale</code> 的配置可以插件它的<a href="https://umijs.org/plugin/umi-plugin-react.html#locale" target="_blank" rel="noopener">文档</a>。</p>
<h3 id="支持风格切换"><a href="#支持风格切换" class="headerlink" title="支持风格切换"></a>支持风格切换</h3><p>Ant Design Pro 使用了 less + cssModule 作为样式的解决方案，你可以通过配置 less 编译时的 lessVars 来就该主题样式配置，在 umi 中内置了该功能，你可以在配置文件中配置 <code>theme</code> 来实现。参考 umi 的<a href="https://umijs.org/config/#theme" target="_blank" rel="noopener">配置文档</a>。</p>
<p>但是 v2 版本支持的导航布局方式等的调整主要是代码的业务逻辑的升级，你可以参考 v2 代码中的 <code>src/layouts/BasicLayout.js</code> 的代码做调整。</p>
<p>对于在线的主题切换，因为 less 是在构建时编译的，要想实现在切换，需要支持 less 在在线编译等问题。为了解决该问题，我们开发了 <code>ant-design-theme</code> 的 webpack 插件和 <code>merge-less</code> 插件一起实现了这样的功能。如果你有需要，你可以参考 v2 代码中的 <code>config/plugin.config.js</code> 和 <code>src/models/setting.js</code> 来添加对应代码。</p>
<h3 id="更多"><a href="#更多" class="headerlink" title="更多"></a>更多</h3><p>更多请查看 Ant Design Pro 2.0 <a href="https://www.yuque.com/ant-design/ant-design-pro/ant_design_pro_2.0_is_out" target="_blank" rel="noopener">发布日志</a>。</p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls" data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
                <ul id="audio-list" style="display:none">
                    
                        <li title='0' data-url='http://link.hhtjim.com/163/5146554.mp3'></li>
                    
                        <li title='1' data-url='http://link.hhtjim.com/qq/001faIUs4M2zna.mp3'></li>
                    
                </ul>
            
        </div>
        
    <div id='gitalk-container' class="comment link"
        data-ae='false'
        data-ci=''
        data-cs=''
        data-r=''
        data-o=''
        data-a=''
        data-d='false'
    >查看评论</div>


    </div>
    
</div>


    </div>
</div>
</body>
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script src="//lib.baomitu.com/jquery/1.8.3/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/diaspora.js"></script>
<link rel="stylesheet" href="/photoswipe/photoswipe.css">
<link rel="stylesheet" href="/photoswipe/default-skin/default-skin.css">
<script src="/photoswipe/photoswipe.min.js"></script>
<script src="/photoswipe/photoswipe-ui-default.min.js"></script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>




</html>